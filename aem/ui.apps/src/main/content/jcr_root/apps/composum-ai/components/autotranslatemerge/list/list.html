<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Translation Merge UI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <sly data-sly-use.clientLib="/libs/granite/sightly/templates/clientlib.html"/>
    <sly data-sly-call="${clientLib.css @ categories='cq.authoring.editor.core'}"></sly>
    <link rel="stylesheet" href="${resource.path @ context='uri'}/list.css">
</head>
<body class="coral--light foundation-layout-util-maximized-alt show-diffs hide-currenttext">
<div class="foundation-layout-panel">
    <div class="foundation-layout-panel-bodywrapper spectrum-ready">
        <div class="foundation-layout-panel-body">
            <div class="foundation-layout-panel-content foundation-layout-form foundation-layout-form-mode-edit">
                <div class="cq-dialog-content-page">
                    <sly data-sly-use.model="com.composum.ai.aem.core.impl.autotranslate.AutoTranslateMergeModel">
                        <section class="coral-Form-fieldset">
                            <h2 class="coral-Form-fieldset-legend">Translation Merge Tool</h2>
                            <span class="coral-Form-field foundation-layout-util-breakword">
                                Instructions: you can review and edit translations for modified properties below.
                                Only component properties where the inheritance has been cancelled and where
                                the blueprint was modified after cancelling inheritance or the last merging are displayed
                                - until they are marked as merged.
                            </span>
                        </section>
                        <section class="coral-Form-fieldset propertytable">
                            <table is="coral-table">
                                <thead is="coral-table-head" sticky>
                                <tr is="coral-table-row">
                                    <th is="coral-table-headercell" class="previoussrc">Previously Translated Text</th>
                                    <th is="coral-table-headercell" class="newsrc">New Text</th>
                                    <th is="coral-table-headercell" class="srcdiffs">Original Diffs</th>
                                    <th is="coral-table-headercell" class="newtrans">New Text Translation</th>
                                    <th is="coral-table-headercell" class="editor">Edit Current Text</th>
                                    <th is="coral-table-headercell" class="currenttext">Current Text on Page</th>
                                </tr>
                                </thead>
                                <tbody is="coral-table-body" class="propertiestable">
                                <sly data-sly-list.property="${model.properties}">
                                    <tr is="coral-table-row" class="row-separator" id="row-${propertyList.index}">
                                        <td is="coral-table-cell" class="row-separator"
                                            colspan="6">
                                            ${property.componentTitle} ${property.pathInPage}
                                            ${property.wrapper.propertyName}</td>
                                    </tr>
                                    <tr is="coral-table-row" class="property-row"
                                        data-path="${property.path}"
                                        data-propertyname="${property.wrapper.propertyName}"
                                        data-language="${model.pageLanguage}"
                                        data-os="${property.wrapper.originalCopy}"
                                        data-ot="${property.wrapper.translatedCopy}"
                                        data-ns="${property.wrapper.newOriginalCopy}"
                                        data-nt="${property.wrapper.newTranslatedCopy}"
                                        data-sd="${property.originalCopyDiffsHTML}"
                                        data-e="${property.wrapper.currentValue}"
                                        data-isrich="${property.wrapper.isRichText}">
                                        <td is="coral-table-cell" class="previoussrc diffscolor">
                                            <p data-sly-unwrap="${property.wrapper.isRichText}">
                                                ${property.originalCopyInsertionsMarked @ context='html'}
                                            </p>
                                        </td>
                                        <td is="coral-table-cell" class="newsrc diffscolor">
                                            <p data-sly-unwrap="${property.wrapper.isRichText}">
                                                ${property.newOriginalCopyInsertionsMarked @ context='html'}
                                            </p>
                                        </td>
                                        <td is="coral-table-cell"
                                            class="srcdiffs diffscolor">
                                            <p data-sly-unwrap="${property.wrapper.isRichText}">
                                            ${property.originalCopyDiffsHTML @ context='html'}</td>
                                        </p>
                                        <td is="coral-table-cell"
                                            class="newtrans">
                                            <div class="newtrans-text">
                                                <sly data-sly-test.isrichtext="${property.wrapper.isRichText}">
                                                    ${property.wrapper.newTranslatedCopy @ context='html'}
                                                </sly>
                                                <sly data-sly-test="${!isrichtext}">
                                                    <p>${property.wrapper.newTranslatedCopy @ context='text'}</p>
                                                </sly>
                                            </div>
                                            <div class="row-actions">
                                                <button is="coral-button" variant="secondary"
                                                        class="copy-to-editor">Copy to Editor
                                                </button>
                                                <!-- <button is="coral-button" variant="secondary"
                                                        class="append-to-editor">Append to Editor
                                                </button> -->
                                                <button is="coral-button" variant="secondary"
                                                        class="intelligent-merge">AI Merge
                                                    <coral-wait size="S" class="spinner"></coral-wait>
                                                </button>
                                                <coral-tooltip placement="right" target=".intelligent-merge">
                                                    <span slot="content">Intelligent merge will try to merge the new text with the current text in the editor, trying to prefer the current text but incorporating changes in the new text.</span>
                                                </coral-tooltip>
                                            </div>
                                        </td>
                                        <td is="coral-table-cell" class="editor">
                                            <div class="rte-container"
                                                 data-sly-test.isrichtext="${property.wrapper.isRichText}">
                                                <div class="rte-toolbar">
                                                    <button class="rte-btn" is="coral-button" variant="minimal"
                                                            title="Bold" icon="textBold"
                                                            data-command="bold"></button>
                                                    <button is="coral-button" variant="minimal" title="Italic"
                                                            icon="textItalic"
                                                            data-command="italic"></button>
                                                    <button is="coral-button" variant="minimal" title="Underline"
                                                            icon="textUnderline"
                                                            data-command="underline"></button>
                                                    <button is="coral-button" variant="minimal" title="Bullet List"
                                                            icon="textBulleted"
                                                            data-command="insertUnorderedList"></button>
                                                    <button is="coral-button" variant="minimal" title="Numbered List"
                                                            icon="textNumbered"
                                                            data-command="insertOrderedList"></button>
                                                </div>
                                                <div class="rte-editor" contenteditable="true">
                                                    ${property.wrapper.currentValue @ context='html'}
                                                </div>
                                            </div>
                                            <div class="text-container" data-sly-test="${!isrichtext}">
                                                <textarea class="text-editor" rows="3" data-sly-text="${property.wrapper.currentValue}"></textarea>
                                            </div>
                                            <div class="editor-actions">
                                                <button is="coral-button" variant="secondary" class="reset-editor">
                                                    Reset
                                                </button>
                                                <button is="coral-button" variant="secondary" class="save-editor"
                                                        disabled>
                                                    Save and Finish
                                                    <coral-wait size="S" class="spinner"></coral-wait>
                                                </button>
                                                <a href="#" data-backwardid="${propertyList.index}"
                                                   data-sly-test="${!propertyList.first}">
                                                    <button is="coral-button" size="S" variant="minimal" icon="arrowUp"
                                                            class="move-up" title="Up"></button>
                                                </a>
                                                <a href="#" data-forwardid="${propertyList.index}"
                                                   data-sly-test="${!propertyList.last}">
                                                    <button is="coral-button" size="S" variant="minimal"
                                                            icon="arrowDown" class="move-down" title="Down"></button>
                                                </a>
                                            </div>
                                        </td>
                                        <td is="coral-table-cell" class="currenttext">
                                            <div class="current-text">
                                                <p data-sly-unwrap="${property.wrapper.isRichText}">
                                                    ${property.wrapper.currentValue @ context='html'}
                                                </p>
                                            </div>
                                        </td>
                                    </tr>
                                </sly>
                                </tbody>
                            </table>
                        </section>
                        <section class="coral-Form-fieldset bottombar coral--light">
                            <p class="errormessage" hidden>
                                <coral-alert variant="error">
                                    <coral-alert-content class="alertcontent"></coral-alert-content>
                                </coral-alert>
                            </p>
                            <a>
                                <button is="coral-button" variant="secondary" class="toggle-diffs">
                                    Toggle Diff Column
                                </button>
                            </a>
                            <a>
                                <button is="coral-button" variant="secondary" class="toggle-current">
                                    Toggle Current Text Column
                                </button>
                            </a>
                            <a href="/editor.html${model.pagePath}.html" target="_blank">
                                <button is="coral-button" variant="secondary">
                                    Open in Editor
                                </button>
                            </a>
                            <a href="${model.pagePath}.html?wcmmode=preview" target="_blank">
                                <button is="coral-button" variant="secondary">
                                    Open as Preview
                                </button>
                            </a>
                            <a href="/apps/composum-ai/components/tool/comparetool.html${model.pagePath}"
                               target="_blank">
                                <button is="coral-button" variant="secondary">
                                    Open in Compare Blueprint Tool
                                </button>
                            </a>
                        </section>
                    </sly>
                </div>
            </div>
        </div>
    </div>
</div>
<sly data-sly-call="${clientLib.js @ categories='coralui3,granite.ui.foundation.content'}"></sly>
<sly data-sly-call="${clientLib.js @ categories='cq.authoring.editor.core'}"></sly>
<script src="${resource.path @ context='uri'}/list.js"></script>
</body>
</html>

<!-- AIGenVersion(62d682fb, list.html.prompt-3b29852a, 8.2AutomaticTranslationMergeTool.md-4eae22e4) -->
